---
title: "GrossAff"
author: "Dvora"
date: "18 12 2019"
output: html_document
editor_options: 
  chunk_output_type: console
---
GetCoords: Download data from GBIF and OBIS  -  Ori and Sarah
input: species list
output: coordinates dataframe


GetEnv: Load environmental data (e.g. temperature) from Bio-ORACLE and GMED  - | Ori and Sarah
input: Define a resolution and extent.
Load environmental layers


GrossAff - Gross affinity from GBIF data 

input â€“ overlay GetCoords + GetEnv
output: summary statistics (mean, median, mode, quantiles, SD, range, etc.)




Load packages
```{r}
library(tidyverse)
library(sdmpredictors)

library(dismo)
library(jsonlite)

```

cerate example data, with coordinate for Boops boops.
the data coords has the coordinate, with "lat" and "lon" column
```{r}
sp_data = read.csv(file = "sp.data.CSV")
sp_data = sp_data %>% filter(species=="Boops boops")
coords = sp_data %>% select(lon,lat)

```


Explore layers:
Create a variable that lists all layers available
```{r}
all_bio_layers <- list_layers(datasets = "Bio-ORACLE", marine = TRUE) %>%
  dplyr::select(layer_code, name)

all_bio_layers %>% filter(stringr::str_detect(.$name, "temperature")) # layers associated with the word 'temperature'

```

Load layers from Bio-Oracle (1) and extract values matching a dataframe of coordinates (2)
```{r}
temp_range <- load_layers(c("BO2_temprange_ss"), datadir = "Bio ORACLE data") # temperature raster for the whole world

range_t <- raster::extract(temp_range[[1]], coords, df = TRUE) # extract according to 'coords' dataframe (lon-lat)


```

`coords` should be a dataframe of coordinates (lat and lon)

Note: this code is using an example of one type of temperature layer


summary of the temperature
summary statistics (mean, median, mode, quantiles, SD, range, etc.)

```{r}
library(summarytools)
mydata <- summarytools::descr(range_t)
mydata = as.data.frame(mydata)
```

